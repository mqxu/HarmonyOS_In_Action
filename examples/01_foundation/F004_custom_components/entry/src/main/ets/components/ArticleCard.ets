import { Article } from '../models/Article';

/**
 * æ–‡ç« å¡ç‰‡ç»„ä»¶
 * æ¼”ç¤º @Builder å’Œ @BuilderParam çš„ä½¿ç”¨
 */
@Component
export struct ArticleCard {
  @Prop article: Article;
  // è‡ªå®šä¹‰å¤´éƒ¨æ„å»ºå™¨
  @BuilderParam customHeader: () => void = this.defaultHeader;
  // è‡ªå®šä¹‰åº•éƒ¨æ„å»ºå™¨
  @BuilderParam customFooter: () => void = this.defaultFooter;

  /**
   * é»˜è®¤å¤´éƒ¨Builder
   */
  @Builder
  defaultHeader() {
    Row({ space: 8 }) {
      Text(this.article.author)
        .fontSize(14)
        .fontColor($r('app.color.text_primary'))
        .fontWeight(FontWeight.Medium)

      Text('Â·')
        .fontSize(14)
        .fontColor($r('app.color.text_tertiary'))

      Text('2å°æ—¶å‰')
        .fontSize(12)
        .fontColor($r('app.color.text_tertiary'))
    }
    .width('100%')
    .padding({ left: 16, right: 16, top: 12 })
  }

  /**
   * é»˜è®¤åº•éƒ¨Builder
   */
  @Builder
  defaultFooter() {
    Row({ space: 24 }) {
      this.ActionButton('â¤ï¸', this.article.likes.toString())
      this.ActionButton('ğŸ’¬', this.article.comments.toString())
      this.ActionButton('ğŸ”–', 'æ”¶è—')
      this.ActionButton('ğŸ“¤', 'åˆ†äº«')
    }
    .width('100%')
    .padding({ left: 16, right: 16, bottom: 12 })
    .justifyContent(FlexAlign.SpaceBetween)
  }

  /**
   * æ“ä½œæŒ‰é’®Builder
   */
  @Builder
  ActionButton(icon: string, text: string) {
    Row({ space: 4 }) {
      Text(icon)
        .fontSize(16)

      Text(text)
        .fontSize(13)
        .fontColor($r('app.color.text_secondary'))
    }
  }

  /**
   * æ ‡ç­¾Builder
   */
  @Builder
  TagList() {
    Row({ space: 8 }) {
      ForEach(this.article.tags, (tag: string) => {
        Text(`# ${tag}`)
          .fontSize(12)
          .fontColor($r('app.color.brand_primary'))
          .padding({
            left: 8,
            right: 8,
            top: 4,
            bottom: 4
          })
          .backgroundColor($r('app.color.bg_secondary'))
          .borderRadius(4)
      }, (tag: string) => tag)
    }
  }

  build() {
    Column() {
      // è‡ªå®šä¹‰æˆ–é»˜è®¤å¤´éƒ¨
      this.customHeader()

      // æ–‡ç« å†…å®¹
      Column({ space: 8 }) {
        // æ ‡é¢˜
        Text(this.article.title)
          .fontSize(16)
          .fontWeight(FontWeight.Bold)
          .fontColor($r('app.color.text_primary'))
          .maxLines(2)
          .textOverflow({ overflow: TextOverflow.Ellipsis })

        // æ‘˜è¦
        Text(this.article.summary)
          .fontSize(14)
          .fontColor($r('app.color.text_secondary'))
          .maxLines(3)
          .textOverflow({ overflow: TextOverflow.Ellipsis })
          .margin({ top: 4 })

        // å°é¢å›¾
        Image(this.article.coverImage)
          .width('100%')
          .height(160)
          .borderRadius(8)
          .objectFit(ImageFit.Cover)
          .backgroundColor($r('app.color.bg_secondary'))
          .margin({ top: 8 })

        // æ ‡ç­¾
        this.TagList()
      }
      .alignItems(HorizontalAlign.Start)
      .padding({
        left: 16,
        right: 16,
        top: 8,
        bottom: 8
      })

      // è‡ªå®šä¹‰æˆ–é»˜è®¤åº•éƒ¨
      this.customFooter()
    }
    .width('100%')
    .backgroundColor($r('app.color.bg_primary'))
    .borderRadius(12)
    .margin({ bottom: 12 })
    .shadow({
      radius: 8,
      color: '#0F000000',
      offsetX: 0,
      offsetY: 2
    })
  }
}
