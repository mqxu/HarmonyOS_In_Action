import { UserCard } from '../components/UserCard';
import { ArticleCard } from '../components/ArticleCard';
import { User } from '../models/User';
import { Article } from '../models/Article';
import hilog from '@ohos.hilog';

@Entry
@Component
struct Index {
  // æ¨¡æ‹Ÿç”¨æˆ·æ•°æ®
  private users: User[] = [
    new User(1, 'å¼ ä¸‰', 'ðŸ‘¨â€ðŸ’»', 'HarmonyOS å¼€å‘å·¥ç¨‹å¸ˆ', 'ä¸“æ³¨äºŽé¸¿è’™åº”ç”¨å¼€å‘ï¼Œåˆ†äº«æŠ€æœ¯å¿ƒå¾—'),
    new User(2, 'æŽå››', 'ðŸ‘©â€ðŸŽ¨', 'UI/UX è®¾è®¡å¸ˆ', 'çƒ­çˆ±è®¾è®¡ï¼Œè¿½æ±‚æžè‡´ç”¨æˆ·ä½“éªŒ'),
    new User(3, 'çŽ‹äº”', 'ðŸ‘¨â€ðŸ«', 'æŠ€æœ¯è®²å¸ˆ', 'è‡´åŠ›äºŽé¸¿è’™æŠ€æœ¯æŽ¨å¹¿å’Œæ•™è‚²')
  ];

  // æ¨¡æ‹Ÿæ–‡ç« æ•°æ®
  private articles: Article[] = [
    new Article(
      1,
      'æ·±å…¥ç†è§£ HarmonyOS è‡ªå®šä¹‰ç»„ä»¶å¼€å‘',
      'å¼ ä¸‰',
      'ðŸ“±',
      'æœ¬æ–‡å°†è¯¦ç»†ä»‹ç» HarmonyOS ä¸­è‡ªå®šä¹‰ç»„ä»¶çš„å¼€å‘æŠ€å·§ï¼ŒåŒ…æ‹¬ @Componentã€@Builderã€@BuilderParam ç­‰æ ¸å¿ƒè£…é¥°å™¨çš„ä½¿ç”¨æ–¹æ³•...',
      ['HarmonyOS', 'ArkTS', 'ç»„ä»¶å¼€å‘'],
      128,
      32
    ),
    new Article(
      2,
      'ArkTS è£…é¥°å™¨å®Œå…¨æŒ‡å—',
      'æŽå››',
      'ðŸŽ¨',
      'è£…é¥°å™¨æ˜¯ ArkTS ä¸­çš„æ ¸å¿ƒç‰¹æ€§ï¼Œæœ¬æ–‡å°†ç³»ç»Ÿåœ°ä»‹ç»å„ç±»è£…é¥°å™¨çš„ä½¿ç”¨åœºæ™¯å’Œæœ€ä½³å®žè·µ...',
      ['ArkTS', 'è£…é¥°å™¨', 'æœ€ä½³å®žè·µ'],
      256,
      48
    )
  ];

  /**
   * å¯¼èˆªåˆ°è‡ªå®šä¹‰ç»„ä»¶é¡µé¢
   */
  private navigateToCustomComponent(): void {
    this.getUIContext().getRouter().pushUrl({
      url: 'pages/CustomComponentPage'
    }).catch((error: Error) => {
      hilog.error(0x0000, 'F004', `Navigation failed: ${error.message}`);
    });
  }

  /**
   * å¯¼èˆªåˆ° Builder é¡µé¢
   */
  private navigateToBuilder(): void {
    this.getUIContext().getRouter().pushUrl({
      url: 'pages/BuilderPage'
    }).catch((error: Error) => {
      hilog.error(0x0000, 'F004', `Navigation failed: ${error.message}`);
    });
  }

  build() {
    Column() {
      // æ ‡é¢˜æ 
      Row() {
        Text('è‡ªå®šä¹‰ç»„ä»¶ä¸Žå¤ç”¨')
          .fontSize(20)
          .fontWeight(FontWeight.Bold)
          .fontColor($r('app.color.text_primary'))
      }
      .width('100%')
      .height(56)
      .padding({ left: 16, right: 16 })
      .backgroundColor($r('app.color.bg_primary'))

      Scroll() {
        Column({ space: 16 }) {
          // ç¤ºä¾‹è¯´æ˜Ž
          Text('æœ¬æ¡ˆä¾‹æ¼”ç¤º HarmonyOS è‡ªå®šä¹‰ç»„ä»¶çš„ä¸‰ç§æ ¸å¿ƒæŠ€æœ¯ï¼š')
            .fontSize(14)
            .fontColor($r('app.color.text_secondary'))
            .width('100%')
            .padding({ left: 16, right: 16 })

          // å¯¼èˆªå¡ç‰‡
          Column({ space: 12 }) {
            this.NavCard('1. @Component ç»„ä»¶', 'åˆ›å»ºå¯å¤ç”¨çš„è‡ªå®šä¹‰ç»„ä»¶', () => {
              this.navigateToCustomComponent()
            })
            this.NavCard('2. @Builder æž„å»ºå‡½æ•°', 'åˆ›å»ºè½»é‡çº§UIæž„å»ºå‡½æ•°', () => {
              this.navigateToBuilder()
            })
            this.NavCard('3. @BuilderParam å‚æ•°', 'å®žçŽ°ç»„ä»¶å†…å®¹å®šåˆ¶', () => {
              this.navigateToBuilder()
            })
          }
          .width('100%')
          .padding({ left: 16, right: 16 })

          // ç”¨æˆ·å¡ç‰‡ç¤ºä¾‹
          Text('@Component ç¤ºä¾‹ - ç”¨æˆ·å¡ç‰‡')
            .fontSize(16)
            .fontWeight(FontWeight.Bold)
            .fontColor($r('app.color.text_primary'))
            .width('100%')
            .padding({ left: 16, right: 16 })
            .margin({ top: 8 })

          Row({ space: 12 }) {
            ForEach(this.users, (user: User) => {
              UserCard({
                user: user,
                cardWidth: 180,
                showActions: false
              })
            }, (user: User) => user.id.toString())
          }
          .width('100%')
          .padding({ left: 16, right: 16 })

          // æ–‡ç« å¡ç‰‡ç¤ºä¾‹
          Text('@Builder + @BuilderParam ç¤ºä¾‹ - æ–‡ç« å¡ç‰‡')
            .fontSize(16)
            .fontWeight(FontWeight.Bold)
            .fontColor($r('app.color.text_primary'))
            .width('100%')
            .padding({ left: 16, right: 16 })
            .margin({ top: 8 })

          Column() {
            ForEach(this.articles, (article: Article) => {
              ArticleCard({ article: article })
            }, (article: Article) => article.id.toString())
          }
          .width('100%')
          .padding({ left: 16, right: 16 })
        }
        .padding({ top: 16, bottom: 16 })
      }
      .layoutWeight(1)
      .backgroundColor($r('app.color.bg_secondary'))
    }
    .width('100%')
    .height('100%')
  }

  /**
   * å¯¼èˆªå¡ç‰‡ Builder
   */
  @Builder
  NavCard(title: string, description: string, onClick: () => void) {
    Row({ space: 12 }) {
      Column({ space: 4 }) {
        Text(title)
          .fontSize(15)
          .fontWeight(FontWeight.Medium)
          .fontColor($r('app.color.text_primary'))

        Text(description)
          .fontSize(13)
          .fontColor($r('app.color.text_secondary'))
      }
      .alignItems(HorizontalAlign.Start)
      .layoutWeight(1)

      Text('â†’')
        .fontSize(18)
        .fontColor($r('app.color.text_tertiary'))
    }
    .width('100%')
    .padding(16)
    .backgroundColor($r('app.color.bg_primary'))
    .borderRadius(8)
    .onClick(onClick)
  }
}
